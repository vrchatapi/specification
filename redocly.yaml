# See https://redoc.ly/docs/cli/configuration/ for more information.
extends:
  - recommended

plugins:
  - ./redocly/plugin.ts

preprocessors:
  vrchat/x-if: on

apis:
  legacy:
    root: openapi/openapi.yaml
    output: dist/openapi-legacy.json
    decorators:
      remove-x-internal: on

  modern:
    root: openapi/openapi.yaml
    output: dist/openapi.json
    decorators:
      remove-x-internal: on
    preprocessors:
      vrchat/x-if:
        defines:
          - jsonschema

  legacy-internal:
    root: openapi/openapi.yaml
    output: dist/openapi-internal+legacy.json
    preprocessors:
      vrchat/x-if:
        defines:
          - internal

  modern-internal:
    root: openapi/openapi.yaml
    output: dist/openapi-internal.json
    preprocessors:
      vrchat/x-if:
        defines:
          - jsonschema
          - internal

  legacy-yaml:
    root: openapi/openapi.yaml
    output: dist/openapi-legacy.yaml
    decorators:
      remove-x-internal: on

  modern-yaml:
    root: openapi/openapi.yaml
    output: dist/openapi.yaml
    decorators:
      remove-x-internal: on
    preprocessors:
      vrchat/x-if:
        defines:
          - jsonschema

  legacy-internal-yaml:
    root: openapi/openapi.yaml
    output: dist/openapi-internal+legacy.yaml
    preprocessors:
      vrchat/x-if:
        defines:
          - internal

  modern-internal-yaml:
    root: openapi/openapi.yaml
    output: dist/openapi-internal.yaml
    preprocessors:
      vrchat/x-if:
        defines:
          - jsonschema
          - internal
